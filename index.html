<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel Master Challenge: Skills for Business</title>
<style>
body {
font-family: "Segoe UI", sans-serif;
background: linear-gradient(135deg, #0a9396, #005f73);
color: #fff;
text-align: center;
margin: 0;
padding: 0;
}
h1 { margin-top: 20px; }
.container {
background: #fff;
color: #000;
margin: 20px auto;
padding: 20px;
border-radius: 12px;
width: 85%;
max-width: 600px;
box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}
button {
background-color: #0a9396;
color: #fff;
border: none;
border-radius: 8px;
padding: 10px 20px;
margin: 10px;
cursor: pointer;
font-size: 1em;
}
button:hover { background-color: #007f89; }
.progress-bar {
width: 80%;
background: #ccc;
border-radius: 8px;
margin: 20px auto;
overflow: hidden;
}
.progress { height: 15px; background: #94d2bd; width: 0%; transition: width 0.3s; }
#timer { font-size: 1.2em; color: #ffb703; margin-top: 10px; }
table {
width: 80%;
margin: 20px auto;
background: #fff;
color: #000;
border-collapse: collapse;
border-radius: 10px;
overflow: hidden;
}
th, td { padding: 8px 10px; border-bottom: 1px solid #ccc; }
</style>
</head>
<body>

<h1>üìä Excel Master Challenge: Skills for Business</h1>

<div class="container">
<div id="login">
<p>Ingresa tu nombre o correo para comenzar:</p>
<input type="text" id="playerName" placeholder="Tu nombre o correo"><br><br>
<p>Selecciona el nivel de evaluaci√≥n:</p>
<select id="level">
<option value="basico">Nivel B√°sico</option>
<option value="intermedio">Nivel Intermedio</option>
<option value="avanzado">Nivel Avanzado</option>
</select><br><br>
<button id="startBtn">Iniciar Evaluaci√≥n</button>
</div>

<div id="game" style="display:none;">
<p id="question"></p>
<div id="options"></div>
<p id="timer"></p>
<div class="progress-bar"><div class="progress" id="progress"></div></div>
</div>

<div id="result"></div>
</div>

<h2>üèÖ Ranking General</h2>
<table id="rankingTable">
<thead><tr><th>Nombre</th><th>Nivel</th><th>Puntaje</th><th>Fecha</th></tr></thead>
<tbody></tbody>
</table>

<script>
// ==================== PREGUNTAS POR NIVEL ====================
const preguntas = {
basico: [
{ q: "¬øQu√© atajo abre un libro nuevo en Excel?", options: ["Ctrl + N", "Ctrl + O", "Ctrl + L", "Ctrl + W"], answer: "Ctrl + N" },
{ q: "¬øQu√© funci√≥n suma un rango de celdas?", options: ["SUM", "COUNT", "AVERAGE", "ADD"], answer: "SUM" },
{ q: "¬øQu√© hace la funci√≥n AVERAGE?", options: ["Cuenta celdas", "Calcula promedio", "Muestra m√°ximo", "Suma valores"], answer: "Calcula promedio" },
{ q: "¬øQu√© s√≠mbolo se usa para f√≥rmulas?", options: ["@", "=", "+", "#"], answer: "=" },
{ q: "¬øC√≥mo se llama la pesta√±a donde se crean gr√°ficos?", options: ["Inicio", "Insertar", "F√≥rmulas", "Datos"], answer: "Insertar" },
{ q: "¬øQu√© hace Ctrl + C?", options: ["Pega", "Copia", "Corta", "Deshace"], answer: "Copia" },
{ q: "¬øQu√© tipo de dato maneja la funci√≥n TODAY()?", options: ["Texto", "N√∫mero", "Fecha", "Hora"], answer: "Fecha" },
{ q: "¬øQu√© hace la funci√≥n MAX?", options: ["Devuelve el mayor valor", "Cuenta celdas", "Suma", "Promedia"], answer: "Devuelve el mayor valor" },
{ q: "¬øQu√© opci√≥n ordena datos?", options: ["Filtros", "Ordenar", "Buscar", "Tabla din√°mica"], answer: "Ordenar" },
{ q: "¬øQu√© es una celda activa?", options: ["La celda seleccionada", "La primera del libro", "La celda bloqueada", "Una celda vac√≠a"], answer: "La celda seleccionada" }
],
intermedio: [
{ q: "¬øQu√© hace la funci√≥n CONCAT?", options: ["Suma n√∫meros", "Une textos", "Convierte texto a n√∫mero", "Divide texto"], answer: "Une textos" },
{ q: "¬øQu√© hace la funci√≥n IF?", options: ["Compara valores", "Suma filas", "Filtra datos", "Ordena valores"], answer: "Compara valores" },
{ q: "¬øQu√© diferencia hay entre COUNT y COUNTA?", options: ["COUNT cuenta n√∫meros y COUNTA todo tipo de datos", "Son iguales", "COUNTA solo texto", "COUNT solo texto"], answer: "COUNT cuenta n√∫meros y COUNTA todo tipo de datos" },
{ q: "¬øQu√© hace el formato condicional?", options: ["Cambia color seg√∫n criterios", "Cambia tama√±o de texto", "Oculta celdas", "Ordena filas"], answer: "Cambia color seg√∫n criterios" },
{ q: "¬øQu√© herramienta se usa para resumir datos r√°pidamente?", options: ["Gr√°ficos", "Tablas din√°micas", "Filtros", "Escenarios"], answer: "Tablas din√°micas" },
{ q: "¬øQu√© funci√≥n busca un valor en una columna?", options: ["VLOOKUP", "SUMIF", "MATCH", "FILTER"], answer: "VLOOKUP" },
{ q: "¬øQu√© funci√≥n redondea un n√∫mero?", options: ["ROUND", "INT", "DECIMAL", "FLOOR"], answer: "ROUND" },
{ q: "¬øQu√© herramienta agrupa datos num√©ricos por intervalos?", options: ["Agrupar en tabla din√°mica", "Buscar objetivo", "Solver", "Formato condicional"], answer: "Agrupar en tabla din√°mica" },
{ q: "¬øQu√© hace Ctrl + Shift + L?", options: ["Aplica filtros", "Abre cuadro de nombre", "Cierra Excel", "Selecciona hoja"], answer: "Aplica filtros" },
{ q: "¬øQu√© es un rango con nombre?", options: ["Conjunto de celdas nombradas", "Una celda bloqueada", "Un filtro", "Un gr√°fico"], answer: "Conjunto de celdas nombradas" }
],
avanzado: [
{ q: "¬øQu√© funci√≥n reemplaza VLOOKUP en versiones modernas?", options: ["MATCH", "XLOOKUP", "FILTER", "SEARCH"], answer: "XLOOKUP" },
{ q: "¬øQu√© herramienta optimiza resultados con restricciones?", options: ["Solver", "Escenarios", "Buscar objetivo", "Filtros"], answer: "Solver" },
{ q: "¬øQu√© hace la funci√≥n INDEX?", options: ["Devuelve valor en posici√≥n espec√≠fica", "Cuenta filas", "Ordena datos", "Busca duplicados"], answer: "Devuelve valor en posici√≥n espec√≠fica" },
{ q: "¬øQu√© combinaci√≥n permite b√∫squedas din√°micas?", options: ["INDEX + MATCH", "IF + OR", "VLOOKUP + OFFSET", "FILTER + SORT"], answer: "INDEX + MATCH" },
{ q: "¬øQu√© hace TRIM?", options: ["Elimina espacios extra", "Convierte texto en n√∫mero", "Redondea valores", "Combina texto"], answer: "Elimina espacios extra" },
{ q: "¬øQu√© hace INDIRECT?", options: ["Devuelve referencia de texto", "Cuenta celdas", "Copia valores", "Convierte n√∫mero en texto"], answer: "Devuelve referencia de texto" },
{ q: "¬øQu√© funci√≥n extrae texto desde el medio de una celda?", options: ["LEFT", "MID", "RIGHT", "TEXT"], answer: "MID" },
{ q: "¬øQu√© funci√≥n convierte texto en n√∫mero?", options: ["VALUE", "TEXT", "NUM", "FORMAT"], answer: "VALUE" },
{ q: "¬øQu√© tipo de gr√°fico muestra participaci√≥n porcentual?", options: ["Circular", "Barras", "L√≠neas", "Histograma"], answer: "Circular" },
{ q: "¬øQu√© hace 'Actualizar todo' en tabla din√°mica?", options: ["Refresca datos origen", "Ordena campos", "Agrega campos", "Duplica tabla"], answer: "Refresca datos origen" }
]
};

let current = 0, score = 0, timer, timeLeft = 20, player = "", nivel = "";
const questionEl = document.getElementById("question");
const optionsEl = document.getElementById("options");
const startBtn = document.getElementById("startBtn");
const timerEl = document.getElementById("timer");
const progressEl = document.getElementById("progress");
const loginEl = document.getElementById("login");
const gameEl = document.getElementById("game");
const resultEl = document.getElementById("result");
const rankingTable = document.querySelector("#rankingTable tbody");

// ==================== INICIO ====================
startBtn.addEventListener("click", () => {
player = document.getElementById("playerName").value.trim();
nivel = document.getElementById("level").value;
if (player === "") { alert("Por favor ingresa tu nombre completo."); return; }
loginEl.style.display = "none";
gameEl.style.display = "block";
current = 0; score = 0;
showQuestion();
});

// ==================== FUNCIONES ====================
function showQuestion() {
const set = preguntas[nivel];
if (current >= set.length) { endGame(); return; }
const q = set[current];
questionEl.textContent = q.q;
optionsEl.innerHTML = "";
q.options.forEach(opt => {
const btn = document.createElement("button");
btn.textContent = opt;
btn.onclick = () => checkAnswer(opt);
optionsEl.appendChild(btn);
});
resetTimer();
progressEl.style.width = `${(current / set.length) * 100}%`;
}

function resetTimer() {
clearInterval(timer);
timeLeft = 20;
timerEl.textContent = `‚è±Ô∏è Tiempo: ${timeLeft}s`;
timer = setInterval(() => {
timeLeft--;
timerEl.textContent = `‚è±Ô∏è Tiempo: ${timeLeft}s`;
if (timeLeft <= 0) {
clearInterval(timer);
current++;
showQuestion();
}
}, 1000);
}

function checkAnswer(selected) {
clearInterval(timer);
const set = preguntas[nivel];
if (selected === set[current].answer) score++;
current++;
showQuestion();
}

function endGame() {
clearInterval(timer);
const set = preguntas[nivel];
const percentage = Math.round((score / set.length) * 100);
const emoji = percentage >= 80 ? "üèÜ" : percentage >= 60 ? "üí™" : "ü•≤";
resultEl.innerHTML = `<h3>Tu puntaje final: ${percentage}% ${emoji}</h3>
<p>${percentage >= 80 ? "¬°Felicidades, aprobaste! Continua con el siguiente nivel." : "No alcanzaste la calificaci√≥n aprobatoria, int√©ntalo nuevamente. Da clic en el bot√≥n Inicio"}</p>
<button onclick="location.reload()">Inicio</button>`;
gameEl.style.display = "none";
saveResult(player, nivel, percentage);
}

// ==================== ENV√çO A POWER AUTOMATE / SHAREPOINT ====================
function saveResult(name, level, score) {
const dateObj = new Date ();
const date = `${String(dateObj.getDate()).padStart(2, '0'}-${String(dateObj.getMonth()+1).padStart(2, '0'}-${dateObj.getFullYear()};
const row = `<tr><td>${name}</td><td>${level}</td><td>${score}%</td><td>${date}</td></tr>`;
rankingTable.innerHTML += row;

const payload = {
Nombre: name,
Nivel: level,
Puntaje: parseInt(score),
Fecha: date
};

// üîó Reemplaza esta URL con la de tu flujo Power Automate
const urlPowerAutomate = "https://default18a01ad89727498aa47d17374c6fd9.f7.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/2539677317d84c6ea2f3ce57620bf0ea/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=S8BpVMQBP7Y5W_u70hu3hj4iTnqxBSzHAAUCku62H9Y";

fetch(urlPowerAutomate, {
method: "POST",
headers: { "Content-Type": "application/json" },
body: JSON.stringify(payload)
})
.then(res => {
if (res.ok) {
console.log("‚úÖ Resultado enviado correctamente a Power Automate / SharePoint");
alert("üéØ Resultado registrado correctamente en SharePoint.");
} else {
console.error("‚ùå Error al enviar los datos: ", res.statusText);
alert("‚ö†Ô∏è Error al registrar resultado. Intenta de nuevo.");
}
})
.catch(err => {
console.error("‚ö†Ô∏è Error de conexi√≥n con Power Automate: ", err);
alert("Error de conexi√≥n al servidor. Revisa la red o el flujo.");
});
}
</script>
</body>
</html>


