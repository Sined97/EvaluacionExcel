<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel Master Challenge: Skills for Business</title>
<style>
body {
font-family: "Segoe UI", sans-serif;
background: linear-gradient(135deg, #0a9396, #005f73);
color: #fff;
text-align: center;
margin: 0;
padding: 0;
}
h1 { margin-top: 20px; }
.container {
background: #fff;
color: #000;
margin: 20px auto;
padding: 20px;
border-radius: 12px;
width: 85%;
max-width: 600px;
box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}
button {
background-color: #0a9396;
color: #fff;
border: none;
border-radius: 8px;
padding: 10px 20px;
margin: 10px;
cursor: pointer;
font-size: 1em;
}
button:hover { background-color: #007f89; }
.progress-bar {
width: 80%;
background: #ccc;
border-radius: 8px;
margin: 20px auto;
overflow: hidden;
}
.progress { height: 15px; background: #94d2bd; width: 0%; transition: width 0.3s; }
#timer { font-size: 1.2em; color: #ffb703; margin-top: 10px; }
.feedback { font-weight: bold; font-size: 1.1em; margin-top: 10px; }
.correct { color: green; }
.incorrect { color: red; }
.explanation { font-style: italic; margin-top: 5px; color: #555; }
table {
width: 80%;
margin: 20px auto;
background: #fff;
color: #000;
border-collapse: collapse;
border-radius: 10px;
overflow: hidden;
}
th, td { padding: 8px 10px; border-bottom: 1px solid #ccc; }
</style>
</head>
<body>

<h1>üìä Excel Master Challenge: Skills for Business</h1>

<div class="container">
<div id="login">
<p>Ingresa tu nombre o correo para comenzar:</p>
<input type="text" id="playerName" placeholder="Tu nombre o correo"><br><br>
<p>Selecciona el nivel de evaluaci√≥n:</p>
<select id="level">
<option value="basico">Nivel B√°sico</option>
<option value="intermedio">Nivel Intermedio</option>
<option value="avanzado">Nivel Avanzado</option>
</select><br><br>
<button id="startBtn">Iniciar Evaluaci√≥n</button>
</div>

<div id="game" style="display:none;">
<p id="question"></p>
<div id="options"></div>
<p id="timer"></p>
<div class="progress-bar"><div class="progress" id="progress"></div></div>
<p class="feedback" id="feedback"></p>
<p class="explanation" id="explanation"></p>
</div>

<div id="result"></div>
</div>

<h2>üèÖ Ranking General</h2>
<table id="rankingTable">
<thead><tr><th>Nombre</th><th>Nivel</th><th>Puntaje</th><th>Fecha</th></tr></thead>
<tbody></tbody>
</table>

<script>
// ==================== PREGUNTAS POR NIVEL ====================
const preguntas = {
basico: [
{ q: "¬øQu√© atajo abre un libro nuevo en Excel?", options: ["Ctrl + N", "Ctrl + O", "Ctrl + L", "Ctrl + W"], answer: "Ctrl + N", explanation: "Ctrl + N abre un nuevo libro de Excel r√°pidamente." },
{ q: "¬øQu√© funci√≥n suma un rango de celdas?", options: ["SUM", "COUNT", "AVERAGE", "ADD"], answer: "SUM", explanation: "La funci√≥n SUM suma los valores de un rango de celdas." },
{ q: "¬øQu√© hace la funci√≥n AVERAGE?", options: ["Cuenta celdas", "Calcula promedio", "Muestra m√°ximo", "Suma valores"], answer: "Calcula promedio", explanation: "AVERAGE calcula el promedio de los n√∫meros en un rango de celdas." },
{ q: "¬øQu√© s√≠mbolo se usa para f√≥rmulas?", options: ["@", "=", "+", "#"], answer: "=", explanation: "Todas las f√≥rmulas en Excel comienzan con el signo igual (=)." },
{ q: "¬øC√≥mo se llama la pesta√±a donde se crean gr√°ficos?", options: ["Inicio", "Insertar", "F√≥rmulas", "Datos"], answer: "Insertar", explanation: "La pesta√±a Insertar contiene todas las opciones para crear gr√°ficos." },
{ q: "¬øQu√© hace Ctrl + C?", options: ["Pega", "Copia", "Corta", "Deshace"], answer: "Copia", explanation: "Ctrl + C copia el contenido seleccionado al portapapeles." },
{ q: "¬øQu√© tipo de dato maneja la funci√≥n TODAY()?", options: ["Texto", "N√∫mero", "Fecha", "Hora"], answer: "Fecha", explanation: "TODAY() devuelve la fecha actual." },
{ q: "¬øQu√© hace la funci√≥n MAX?", options: ["Devuelve el mayor valor", "Cuenta celdas", "Suma", "Promedia"], answer: "Devuelve el mayor valor", explanation: "MAX devuelve el valor m√°ximo dentro de un rango." },
{ q: "¬øQu√© opci√≥n ordena datos?", options: ["Filtros", "Ordenar", "Buscar", "Tabla din√°mica"], answer: "Ordenar", explanation: "La opci√≥n Ordenar permite organizar los datos de menor a mayor o viceversa." },
{ q: "¬øQu√© es una celda activa?", options: ["La celda seleccionada", "La primera del libro", "La celda bloqueada", "Una celda vac√≠a"], answer: "La celda seleccionada", explanation: "La celda activa es aquella que est√° actualmente seleccionada." }
],
// Puedes agregar 'intermedio' y 'avanzado' con sus explicaciones de manera similar
};

let current = 0, score = 0, timer, timeLeft = 20, player = "", nivel = "";
const questionEl = document.getElementById("question");
const optionsEl = document.getElementById("options");
const startBtn = document.getElementById("startBtn");
const timerEl = document.getElementById("timer");
const progressEl = document.getElementById("progress");
const loginEl = document.getElementById("login");
const gameEl = document.getElementById("game");
const resultEl = document.getElementById("result");
const rankingTable = document.querySelector("#rankingTable tbody");
const feedbackEl = document.getElementById("feedback");
const explanationEl = document.getElementById("explanation");
let canAnswer = true;

// ==================== INICIO ====================
startBtn.addEventListener("click", () => {
player = document.getElementById("playerName").value.trim();
nivel = document.getElementById("level").value;
if (player === "") { alert("Por favor ingresa tu nombre completo."); return; }
loginEl.style.display = "none";
gameEl.style.display = "block";
current = 0; score = 0;
showQuestion();
});

// ==================== FUNCIONES ====================
function showQuestion() {
const set = preguntas[nivel];
if (current >= set.length) { endGame(); return; }
const q = set[current];
questionEl.textContent = q.q;
optionsEl.innerHTML = "";
feedbackEl.textContent = "";
explanationEl.textContent = "";
canAnswer = true;

q.options.forEach(opt => {
const btn = document.createElement("button");
btn.textContent = opt;
btn.onclick = () => checkAnswer(opt);
optionsEl.appendChild(btn);
});

resetTimer();
progressEl.style.width = `${(current / set.length) * 100}%`;
}

function resetTimer() {
clearInterval(timer);
timeLeft = 20;
timerEl.textContent = `‚è±Ô∏è Tiempo: ${timeLeft}s`;
timer = setInterval(() => {
timeLeft--;
timerEl.textContent = `‚è±Ô∏è Tiempo: ${timeLeft}s`;
if (timeLeft <= 0) {
clearInterval(timer);
feedbackEl.textContent = "‚è∞ Tiempo agotado!";
feedbackEl.className = "feedback incorrect";
explanationEl.textContent = preguntas[nivel][current].explanation;
canAnswer = false;
setTimeout(() => {
current++;
showQuestion();
}, 2000);
}
}, 1000);
}

function checkAnswer(selected) {
if (!canAnswer) return;
canAnswer = false;
clearInterval(timer);
const set = preguntas[nivel];
const correct = set[current].answer;

if (selected === correct) {
score++;
feedbackEl.textContent = "‚úÖ Correcto!";
feedbackEl.className = "feedback correct";
} else {
feedbackEl.textContent = `‚ùå Incorrecto!`;
feedbackEl.className = "feedback incorrect";
}

explanationEl.textContent = set[current].explanation;

setTimeout(() => {
current++;
showQuestion();
}, 2000);
}

function endGame() {
clearInterval(timer);
const set = preguntas[nivel];
const percentage = Math.round((score / set.length) * 100);
const emoji = percentage >= 80 ? "üèÜ" : percentage >= 60 ? "üí™" : "ü•≤";
resultEl.innerHTML = `<h3>Tu puntaje final: ${percentage}% ${emoji}</h3>
<p>${percentage >= 80 ? "¬°Felicidades, aprobaste! Continua con el siguiente nivel." : "No alcanzaste la calificaci√≥n aprobatoria, int√©ntalo nuevamente."}</p>
<button onclick="location.reload()">Inicio</button>`;
gameEl.style.display = "none";

saveResult(player, nivel, percentage);
}

// ==================== RANKING LOCAL ====================
function saveResult(name, level, score) {
const dateObj = new Date();
const date = `${String(dateObj.getDate()).padStart(2, '0')}-${String(dateObj.getMonth()+1).padStart(2, '0')}-${dateObj.getFullYear()}`;

const row = { name, level, score, date };
if (!window.ranking) window.ranking = [];
window.ranking.push(row);

window.ranking.sort((a,b) => b.score - a.score);

rankingTable.innerHTML = "";
window.ranking.forEach(r => {
rankingTable.innerHTML += `<tr><td>${r.name}</td><td>${r.level}</td><td>${r.score}%</td><td>${r.date}</td></tr>`;
});
}
</script>
</body>
</html>
