<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel Challenge: Skills for Business</title>
<style>
   body {
     font-family: "Segoe UI", sans-serif;
     background: linear-gradient(135deg, #5F2A7F, #A3A3A3); /* Morado y gris */
     color: #fff;
     text-align: center;
     margin: 0;
     padding: 0;
   }
   h1 {
     margin-top: 20px;
   }
   .container {
     background: #fff;
     color: #000;
     margin: 20px auto;
     padding: 20px;
     border-radius: 12px;
     width: 85%;
     max-width: 600px;
     box-shadow: 0 5px 15px rgba(0,0,0,0.2);
   }
   button {
     background-color: #5F2A7F; /* Morado */
     color: #fff;
     border: none;
     border-radius: 8px;
     padding: 10px 20px;
     margin: 10px;
     cursor: pointer;
     font-size: 1em;
   }
   button:hover {
     background-color: #4A1F6C; /* Morado m√°s oscuro */
   }
   .progress-bar {
     width: 80%;
     background: #ccc;
     border-radius: 8px;
     margin: 20px auto;
     overflow: hidden;
   }
   .progress {
     height: 15px;
     background: #5F2A7F; /* Morado */
     width: 0%;
     transition: width 0.3s;
   }
   #timer {
     font-size: 1.2em;
     color: #ffb703;
     margin-top: 10px;
   }
   .feedback {
     font-weight: bold;
     font-size: 1.1em;
     margin-top: 10px;
   }
   .correct {
     color: green;
   }
   .incorrect {
     color: red;
   }
   .explanation {
     font-style: italic;
     margin-top: 5px;
     color: #555;
   }
   table {
     width: 80%;
     margin: 20px auto;
     background: #fff;
     color: #000;
     border-collapse: collapse;
     border-radius: 10px;
     overflow: hidden;
   }
   th, td {
     padding: 8px 10px;
     border-bottom: 1px solid #ccc;
   }
   header {
     display: flex;
     justify-content: center;
     align-items: center;
     gap: 30px;
     padding: 15px;
     background: #fff;
   }
   .logo {
     height: 60px;
     width: auto;
   }
</styl<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel Challenge: Skills for Business</title>
<style>
   body {
     font-family: "Segoe UI", sans-serif;
     background: linear-gradient(135deg, #5F2A7F, #A3A3A3); /* Morado y gris */
     color: #fff;
     text-align: center;
     margin: 0;
     padding: 0;
   }
   h1 {
     margin-top: 20px;
   }
   .container {
     background: #fff;
     color: #000;
     margin: 20px auto;
     padding: 20px;
     border-radius: 12px;
     width: 85%;
     max-width: 600px;
     box-shadow: 0 5px 15px rgba(0,0,0,0.2);
   }
   button {
     background-color: #5F2A7F; /* Morado */
     color: #fff;
     border: none;
     border-radius: 8px;
     padding: 10px 20px;
     margin: 10px;
     cursor: pointer;
     font-size: 1em;
   }
   button:hover {
     background-color: #4A1F6C; /* Morado m√°s oscuro */
   }
   .progress-bar {
     width: 80%;
     background: #ccc;
     border-radius: 8px;
     margin: 20px auto;
     overflow: hidden;
   }
   .progress {
     height: 15px;
     background: #5F2A7F; /* Morado */
     width: 0%;
     transition: width 0.3s;
   }
   #timer {
     font-size: 1.2em;
     color: #ffb703;
     margin-top: 10px;
   }
   .feedback {
     font-weight: bold;
     font-size: 1.1em;
     margin-top: 10px;
   }
   .correct {
     color: green;
   }
   .incorrect {
     color: red;
   }
   .explanation {
     font-style: italic;
     margin-top: 5px;
     color: #555;
   }
   table {
     width: 80%;
     margin: 20px auto;
     background: #fff;
     color: #000;
     border-collapse: collapse;
     border-radius: 10px;
     overflow: hidden;
   }
   th, td {
     padding: 8px 10px;
     border-bottom: 1px solid #ccc;
   }
   header {
     display: flex;
     justify-content: center;
     align-items: center;
     gap: 30px;
     padding: 15px;
     background: #fff;
   }
   .logo {
     height: 60px;
     width: auto;
   }
</style>
</head>
<body>

<!-- Header con 3 logos -->
<header>
    <img src="Salimosaganar.png" alt="Logo Izquierdo" class="logo">
    <img src="MSM.png" alt="Logo Central" class="logo">
    <img src="Portafolio.png" alt="Logo Derecho" class="logo">
</header>

<h1>üìä Excel Challenge: Skills for Business</h1>

<div class="container">
<div id="login">
<p>Ingresa tu nombre para comenzar:</p>
<input type="text" id="playerName" placeholder="Tu nombre y apellidos"><br><br>
<p>Selecciona el nivel de evaluaci√≥n:</p>
<select id="level">
<option value="basico">Nivel B√°sico</option>
<option value="intermedio">Nivel Intermedio</option>
<option value="avanzado">Nivel Avanzado</option>
</select><br><br>
<button id="startBtn">Iniciar Evaluaci√≥n</button>
</div>

<div id="game" style="display:none;">
<p id="question"></p>
<div id="options"></div>
<p id="timer"></p>
<div class="progress-bar"><div class="progress" id="progress"></div></div>
<p class="feedback" id="feedback"></p>
<p class="explanation" id="explanation"></p>
</div>

<div id="result"></div>
</div>

<h2>üèÖ Ranking General</h2>
<table id="rankingTable">
<thead><tr><th>Nombre</th><th>Nivel</th><th>Puntaje</th><th>Fecha</th></tr></thead>
<tbody></tbody>
</table>

<script>
// ==================== PREGUNTAS POR NIVEL ====================
const preguntas = {
basico: [
{ q: "¬øQu√© atajo abre un libro nuevo en Excel?", options: ["Ctrl + N", "Ctrl + O", "Ctrl + L", "Ctrl + W"], answer: "Ctrl + N", explanation: "Ctrl + N abre un nuevo libro de Excel r√°pidamente." },
{ q: "¬øQu√© funci√≥n suma un rango de celdas?", options: ["SUM", "COUNT", "AVERAGE", "ADD"], answer: "SUM", explanation: "La funci√≥n SUM suma los valores de un rango de celdas." },
{ q: "¬øQu√© hace la funci√≥n AVERAGE?", options: ["Cuenta celdas", "Calcula promedio", "Muestra m√°ximo", "Suma valores"], answer: "Calcula promedio", explanation: "AVERAGE calcula el promedio de los n√∫meros en un rango de celdas." },
{ q: "¬øQu√© s√≠mbolo se usa para f√≥rmulas?", options: ["@", "=", "+", "#"], answer: "=", explanation: "Todas las f√≥rmulas en Excel comienzan con el signo igual (=)." },
{ q: "¬øC√≥mo se llama la pesta√±a donde se crean gr√°ficos?", options: ["Inicio", "Insertar", "F√≥rmulas", "Datos"], answer: "Insertar", explanation: "La pesta√±a Insertar contiene todas las opciones para crear gr√°ficos." },
{ q: "¬øQu√© hace Ctrl + C?", options: ["Pega", "Copia", "Corta", "Deshace"], answer: "Copia", explanation: "Ctrl + C copia el contenido seleccionado al portapapeles." },
{ q: "¬øQu√© tipo de dato maneja la funci√≥n TODAY()?", options: ["Texto", "N√∫mero", "Fecha", "Hora"], answer: "Fecha", explanation: "TODAY() devuelve la fecha actual." },
{ q: "¬øQu√© hace la funci√≥n MAX?", options: ["Devuelve el mayor valor", "Cuenta celdas", "Suma", "Promedia"], answer: "Devuelve el mayor valor", explanation: "MAX devuelve el valor m√°ximo dentro de un rango." },
{ q: "¬øQu√© opci√≥n ordena datos?", options: ["Filtros", "Ordenar", "Buscar", "Tabla din√°mica"], answer: "Ordenar", explanation: "La opci√≥n Ordenar permite organizar los datos de menor a mayor o viceversa." },
{ q: "¬øQu√© es una celda activa?", options: ["La celda seleccionada", "La primera del libro", "La celda bloqueada", "Una celda vac√≠a"], answer: "La celda seleccionada", explanation: "La celda activa es aquella que est√° actualmente seleccionada." }
],
intermedio: [
{ q: "¬øQu√© hace la funci√≥n CONCAT?", options: ["Suma n√∫meros", "Une textos", "Convierte texto a n√∫mero", "Divide texto"], answer: "Une textos", explanation: "CONCAT une textos de diferentes celdas en una sola cadena." },
{ q: "¬øQu√© hace la funci√≥n IF?", options: ["Compara valores", "Suma filas", "Filtra datos", "Ordena valores"], answer: "Compara valores", explanation: "IF permite tomar decisiones seg√∫n condiciones l√≥gicas." },
{ q: "¬øQu√© diferencia hay entre COUNT y COUNTA?", options: ["COUNT cuenta n√∫meros y COUNTA todo tipo de datos", "Son iguales", "COUNTA solo texto", "COUNT solo texto"], answer: "COUNT cuenta n√∫meros y COUNTA todo tipo de datos", explanation: "COUNT solo cuenta n√∫meros, COUNTA cuenta todo tipo de celdas no vac√≠as." },
{ q: "¬øQu√© hace el formato condicional?", options: ["Cambia color seg√∫n criterios", "Cambia tama√±o de texto", "Oculta celdas", "Ordena filas"], answer: "Cambia color seg√∫n criterios", explanation: "El formato condicional permite cambiar colores de celdas seg√∫n reglas definidas." },
{ q: "¬øQu√© herramienta se usa para resumir datos r√°pidamente?", options: ["Gr√°ficos", "Tablas din√°micas", "Filtros", "Escenarios"], answer: "Tablas din√°micas", explanation: "Las tablas din√°micas resumen grandes cantidades de datos f√°cilmente." },
{ q: "¬øQu√© funci√≥n busca un valor en una columna?", options: ["VLOOKUP", "SUMIF", "MATCH", "FILTER"], answer: "VLOOKUP", explanation: "VLOOKUP permite buscar un valor espec√≠fico en una columna y devolver datos relacionados." },
{ q: "¬øQu√© funci√≥n redondea un n√∫mero?", options: ["ROUND", "INT", "DECIMAL", "FLOOR"], answer: "ROUND", explanation: "ROUND redondea un n√∫mero al n√∫mero de decimales especificado." },
{ q: "¬øQu√© herramienta agrupa datos num√©ricos por intervalos?", options: ["Agrupar en tabla din√°mica", "Buscar objetivo", "Solver", "Formato condicional"], answer: "Agrupar en tabla din√°mica", explanation: "Agrupar permite organizar datos por rangos dentro de tablas din√°micas." },
{ q: "¬øQu√© hace Ctrl + Shift + L?", options: ["Aplica filtros", "Abre cuadro de nombre", "Cierra Excel", "Selecciona hoja"], answer: "Aplica filtros", explanation: "Esta combinaci√≥n activa o desactiva los filtros en la hoja." },
{ q: "¬øQu√© es un rango con nombre?", options: ["Conjunto de celdas nombradas", "Una celda bloqueada", "Un filtro", "Un gr√°fico"], answer: "Conjunto de celdas nombradas", explanation: "Un rango con nombre permite referirse a un conjunto de celdas f√°cilmente." }
],
avanzado: [
{ q: "¬øQu√© funci√≥n reemplaza VLOOKUP en versiones modernas?", options: ["MATCH", "XLOOKUP", "FILTER", "SEARCH"], answer: "XLOOKUP", explanation: "XLOOKUP reemplaza VLOOKUP y permite b√∫squedas m√°s flexibles." },
{ q: "¬øQu√© herramienta optimiza resultados con restricciones?", options: ["Solver", "Escenarios", "Buscar objetivo", "Filtros"], answer: "Solver", explanation: "Solver encuentra la mejor soluci√≥n cumpliendo restricciones." },
{ q: "¬øQu√© hace la funci√≥n INDEX?", options: ["Devuelve valor en posici√≥n espec√≠fica", "Cuenta filas", "Ordena datos", "Busca duplicados"], answer: "Devuelve valor en posici√≥n espec√≠fica", explanation: "INDEX devuelve el valor de una celda en un rango seg√∫n fila y columna." },
{ q: "¬øQu√© combinaci√≥n permite b√∫squedas din√°micas?", options: ["INDEX + MATCH", "IF + OR", "VLOOKUP + OFFSET", "FILTER + SORT"], answer: "INDEX + MATCH", explanation: "INDEX + MATCH permite b√∫squedas m√°s flexibles que VLOOKUP." },
{ q: "¬øQu√© hace TRIM?", options: ["Elimina espacios extra", "Convierte texto en n√∫mero", "Redondea valores", "Combina texto"], answer: "Elimina espacios extra", explanation: "TRIM elimina espacios iniciales, finales y dobles dentro de un texto." },
{ q: "¬øQu√© hace INDIRECT?", options: ["Devuelve referencia de texto", "Cuenta celdas", "Copia valores", "Convierte n√∫mero en texto"], answer: "Devuelve referencia de texto", explanation: "INDIRECT convierte un texto en referencia v√°lida a celdas." },
{ q: "¬øQu√© funci√≥n extrae texto desde el medio de una celda?", options: ["LEFT", "MID", "RIGHT", "TEXT"], answer: "MID", explanation: "MID extrae una cantidad de caracteres desde el medio de un texto." },
{ q: "¬øQu√© funci√≥n convierte texto en n√∫mero?", options: ["VALUE", "TEXT", "NUM", "FORMAT"], answer: "VALUE", explanation: "VALUE convierte texto que representa un n√∫mero en un valor num√©rico." },
{ q: "¬øQu√© tipo de gr√°fico muestra participaci√≥n porcentual?", options: ["Circular", "Barras", "L√≠neas", "Histograma"], answer: "Circular", explanation: "Los gr√°ficos circulares muestran la proporci√≥n de cada parte respecto al total." },
{ q: "¬øQu√© hace 'Actualizar todo' en tabla din√°mica?", options: ["Refresca datos origen", "Ordena campos", "Agrega campos", "Duplica tabla"], answer: "Refresca datos origen", explanation: "Actualizar todo actualiza los datos que la tabla din√°mica utiliza como origen." }
]
};

let current = 0, score = 0, timer, timeLeft = 20, player = "", nivel = "";
const questionEl = document.getElementById("question");
const optionsEl = document.getElementById("options");
const startBtn = document.getElementById("startBtn");
const timerEl = document.getElementById("timer");
const progressEl = document.getElementById("progress");
const loginEl = document.getElementById("login");
const gameEl = document.getElementById("game");
const resultEl = document.getElementById("result");
const rankingTable = document.querySelector("#rankingTable tbody");
const feedbackEl = document.getElementById("feedback");
const explanationEl = document.getElementById("explanation");
let canAnswer = true;

// ==================== INICIO ====================
startBtn.addEventListener("click", () => {
    player = document.getElementById("playerName").value.trim();
    nivel = document.getElementById("level").value;
    if (player === "") { alert("Por favor ingresa tu nombre completo."); return; }
    loginEl.style.display = "none";
    gameEl.style.display = "block";
    current = 0; score = 0;
    showQuestion();
});

// ==================== FUNCIONES ====================
function showQuestion() {
    const set = preguntas[nivel];
    if (current >= set.length) { endGame(); return; }
    const q = set[current];
    questionEl.textContent = q.q;
    optionsEl.innerHTML = "";
    feedbackEl.textContent = "";
    explanationEl.textContent = "";
    canAnswer = true;

    q.options.forEach(opt => {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.onclick = () => checkAnswer(opt);
        optionsEl.appendChild(btn);
    });

    resetTimer();
    progressEl.style.width = `${(current / set.length) * 100}%`;
}

function resetTimer() {
    clearInterval(timer);
    timeLeft = 20;
    timerEl.textContent = `‚è±Ô∏è Tiempo: ${timeLeft}s`;
    timer = setInterval(() => {
        timeLeft--;
        timerEl.textContent = `‚è±Ô∏è Tiempo: ${timeLeft}s`;
        if (timeLeft <= 0) {
            clearInterval(timer);
            feedbackEl.textContent = "‚è∞ Tiempo agotado!";
            feedbackEl.className = "feedback incorrect";
            explanationEl.textContent = preguntas[nivel][current].explanation;
            canAnswer = false;
            setTimeout(() => {
                current++;
                showQuestion();
            }, 2000);
        }
    }, 1000);
}

function checkAnswer(selected) {
    if (!canAnswer) return;
    canAnswer = false;
    clearInterval(timer);
    const set = preguntas[nivel];
    const correct = set[current].answer;

    if (selected === correct) {
        score++;
        feedbackEl.textContent = "‚úÖ Correcto!";
        feedbackEl.className = "feedback correct";
    } else {
        feedbackEl.textContent = `‚ùå Incorrecto!`;
        feedbackEl.className = "feedback incorrect";
    }

    explanationEl.textContent = set[current].explanation;

    setTimeout(() => {
        current++;
        showQuestion();
    }, 2000);
}

function endGame() {
    clearInterval(timer);
    const set = preguntas[nivel];
    const percentage = Math.round((score / set.length) * 100);
    const emoji = percentage >= 80 ? "üèÜ" : percentage >= 60 ? "üí™" : "ü•≤";
    resultEl.innerHTML = `<h3>Tu puntaje final: ${percentage}% ${emoji}</h3>
    <p>${percentage >= 80 ? "¬°Felicidades, aprobaste! Continua con el siguiente nivel." : "No alcanzaste la calificaci√≥n aprobatoria, int√©ntalo nuevamente."}</p>
    <button onclick="location.reload()">Inicio</button>`;
    gameEl.style.display = "none";

    saveResult(player, nivel, percentage);
}

// ==================== RANKING LOCAL ====================
function saveResult(name, level, score) {
    const dateObj = new Date();
    const date = `${String(dateObj.getDate()).padStart(2, '0')}-${String(dateObj.getMonth()+1).padStart(2, '0')}-${dateObj.getFullYear()}`;

    const row = { name, level, score, date };
    if (!window.ranking) window.ranking = [];
    window.ranking.push(row);

    window.ranking.sort((a,b) => b.score - a.score);

    rankingTable.innerHTML = "";
    window.ranking.forEach(r => {
        rankingTable.innerHTML += `<tr><td>${r.name}</td><td>${r.level}</td><td>${r.score}%</td><td>${r.date}</td></tr>`;
    });
}
</script>
</body>
</html>
